<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>{% block title %}Welcome!{% endblock %}</title>
    {% block stylesheets %}
        <link href="{{ asset('images/favicon.ico') }}" type="text/css" rel="icon"/>
        <link href="{{ asset('css/carousel.css') }}" type="text/css" rel="stylesheet"/>
        <link href="{{ asset('css/style.css') }}" type="text/css" rel="stylesheet"/>
        <link href="{{ asset('css/custom.css') }}" type="text/css" rel="stylesheet"/>
        <link href="{{ asset('css/style-sunset.css') }}" type="text/css" rel="stylesheet"/>
        <link href="{{ asset('css/bootstrap.min.css') }}" type="text/css" rel="stylesheet"/>
        <link href="{{ asset('//fonts.googleapis.com/css?family=Montserrat:400,700%7CLato:300,300italic,400,700,900%7CYesteryear') }}"
              type="text/css" rel="stylesheet"/>
        <link rel="stylesheet" href="{{ asset('css/contabilidad_styles.css') }}">
        <link rel="stylesheet" href="{{ asset('css/tarjetas.css') }}"/>

    {% endblock %}

</head>
<body class="overflow-hidden-x-content fondo">

{# ............ Toasts success ............#}
{{ include('utils/toasts.html.twig') }}

{# ............... Modal Confirm ............. #}
{{ include('utils/modal_confirm.html.twig') }}

{# ................... Site Structure .................. #}

{% include 'layout/header.html.twig' %}

<div class="height-content">
    {% block navBar %}
        <!--NavBar para realizar la navegacion desde los modulos, que lo requieran-->
    {% endblock %}

    {% block content %}
        <!--Contenido del body dinamico-->
    {% endblock %}
</div>
</body>

{% include 'layout/footer.html' %}


{% block javascripts %}
    <script src="{{ asset('js/core.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('js/script.js') }}" type="text/javascript"></script>
    <script src="{{ asset('js/bootstrap.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('js/carousel.js') }}" type="text/javascript"></script>
    <script src="{{ asset('js/contabilidad.js') }}" type="text/javascript"></script>
    <script src="{{ asset('js/jquery.validate.min.js') }}" type="text/javascript"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="{{ asset('js/bootstrap.min.js') }}" type="text/javascript"></script>

    <script>
        $(document).ready(function () {
            let total = null;
            	$.ajax({
            type: 'POST',
            data: {'code' : '200'},
            url: window.location.protocol+"//"+location.hostname+":"+window.location.port+"/carrito",
            dataType: 'html',
            success: function (data) {

				data = JSON.parse(data); 
				for(let i = 0; i < data.length; i++) {
                    let json = JSON.parse(data[i].json); 

                     $("#carrito").append('<li id="li'+i+'"></li>');
                     $("#li"+i).append('<div id="div'+i+'"'+' class="rd-navbar-product-caption"></div>'+ '<a class="svgCarrito" onClick="editarCarrito('+json.id+');" ><svg width="1em" height="1em" viewbox="0 0 16 16" class="iconCarritoEdit box bi bi-pencil-square" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456l-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/><path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/></svg> </a><a class="svgCarrito" onClick="eliminarCarrito('+json.id+');" ><svg  width="1em" height="1em" viewbox="0 0 16 16" class="iconCarritoDelete box bi bi-trash" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4L4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg></a>');
                    // $("#div"+i).append();
                     $("#div"+i).append('<h6 id="h6'+i+'"'+' class="rd-navbar-product-title">'+json.servicio+' '+json.primerNombre+' '+json.primerApellido+'</h6>');
                     $("#h6"+i).append('<p class="rd-navbar-product-price">$'+json.monto+'</p>');
                    

                     total = Number(total) + Number(json.monto);
                     $("#totalCarrito").text("US $"+total);
                     let  iconCarrito = document.getElementById('iconCarrito');
                   iconCarrito.setAttribute('data-count',data.length);
            }
                }});

            $('#new_password').hide()
            $('#repeat_new_password').hide()
            $('#invalid_password').hide()
            $('#btn_change_password').hide()
        })
        $('#btn_cambiar_contrasenna').on('click', function () {
            $('#new_password').show()
            $('#repeat_new_password').show()
        })
        $('#repeat_new_password').on('keyup', function () {
            if ($('#repeat_new_password').val() != $('#new_password').val()) {
                $('#invalid_password').show()
                $('#btn_change_password').hide()
            } else {
                $('#invalid_password').hide()
                $('#btn_change_password').show()
            }
        })
        $('#new_password').on('keyup', function () {
            if ($('#repeat_new_password').val() != $('#new_password').val()) {
                $('#invalid_password').show()
                $('#btn_change_password').hide()
            } else {
                $('#invalid_password').hide()
                $('#btn_change_password').show()
            }
        })
        $('#btn_change_password').on('click', function () {
            $.ajax({
                url: '{{ url('change_password') }}',
                method: "POST",
                data: {'new_password': $('#new_password').val()}
            }).then(res => {
                window.location.replace('/home');
            })
        })
    </script>
{% endblock %}


</html>
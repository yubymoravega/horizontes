{% extends 'base.html.twig' %}
{% block content %}
    {# Modal de Cuentas#}
    <div class="modal fade" id="listarMercanciasModal" tabindex="-1" role="dialog" data-backdrop="static"
         data-keyboard="false"
         aria-labelledby="listarMercanciasModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" style="max-width: 850px;" role="document">
            <div class="modal-content">
                <div class="modal-header bg-dark">
                    <h4 class="modal-title text-light" id="listarMercanciasModalLabel">Listado de mercancias</h4>
                    <button class="close text-light" type="button" data-dismiss="modal" aria-label="Cerrar">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body bg-dark-app" style="height: 600px;">
                    <div style="height: 500px; overflow-y: auto;">
                        <table class="table table-hover text-light">
                            <thead class="thead-dark">
                            <th style="width: 10px">Sel.</th>
                            <th style="width: 160px">Código</th>
                            <th scope="col-6">Descripción</th>
                            <th style="width: 200px">Precio Compra</th>
                            </thead>
                            <tbody id="rows_table">
                            </tbody>
                        </table>
                    </div>
                    <div class="d-flex mt-4">
                        <div class="mr-auto">
                            <button class="btn btn-outline-secondary" type="button" data-dismiss="modal"
                                    aria-label="Cerrar">
                                <span aria-hidden="true">Cancelar</span>
                            </button>
                        </div>
                        <div class="ml-2">
                            <button type="button" class="my-0 btn btn-secondary" id="btnAceptar" onclick=""
                                    data-dismiss="modal">Seleccionar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <div class="container d-flex justify-content-center">
        <div class="card mt-5" style="width: 50rem;">
            <div class="container">
                <h1 class="text-reporte"> Adicionar Informe de Recepción</h1>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-3 form-group input-group input-group-sm pa-1 d-block">
                        <label for="codigo_mercancia" class="font-weight-bold">Código</label>
                        <span class="input-group-append"></span>
                        <div class="row m-0 p-0">
                            <div class="col-8 p-0">
                                <input type="text" name="codigo_mercancia" class="form-control w-100"
                                       id="codigo_mercancia">
                            </div>
                            <div class="col-1 mt-0 p-0">
                                <button class="btn btn-secondary btn-sm" data-toggle="modal"
                                        data-target="#listarMercanciasModal" id="btnSearchMercancia"><i class="fa fa-search"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="col-9 mt-0 form-group input-group input-group-sm d-block p-0">
                        <label for="descripcion_mercancia" class="font-weight-bold">Descripción</label>
                        <span class="input-group-append"></span>
                        <input type="text" name="descripcion_mercancia" class="form-control w-100"
                               id="descripcion_mercancia">
                    </div>
                </div>
                <div class="row mt-0 p-0">
                    <div class="col-6 form-group input-group input-group-sm pa-2 d-block">
                        <label for="unidad_medida" class="font-weight-bold">Unidad Medida</label>
                        <span class="input-group-append"></span>
                        <select type="text" name="unidad_medida" class="form-control w-100"
                                id="unidad_medida"></select>
                    </div>
                    <div class="col-2 mt-0 form-group input-group input-group-sm d-block">
                        <label for="cantidad_mercancia" class="font-weight-bold">Cantidad</label>
                        <span class="input-group-append"></span>
                        <input type="text" name="cantidad_mercancia" class="form-control w-100"
                               id="cantidad_mercancia">
                    </div>
                    <div class="col-2 mt-0 form-group input-group input-group-sm d-block">
                        <label for="importe_mercancia" class="font-weight-bold">Importe</label>
                        <span class="input-group-append"></span>
                        <input type="text" name="importe_mercancia" class="form-control w-100"
                               id="importe_mercancia">
                    </div>
                    <div class="col-2 mt-0 form-group input-group input-group-sm d-block p-0">
                        <label for="precio_mercancia" class="font-weight-bold">Precio</label>
                        <span class="input-group-append"></span>
                        <input type="text" name="precio_mercancia" class="form-control w-100"
                               id="precio_mercancia" disabled>
                    </div>
                </div>
                <div class="row mt-0 p-0">
                    <div class="col-4 form-group input-group input-group-sm pa-2 d-block">
                        <label for="fecha_mercancia" class="font-weight-bold">Fecha Doc.</label>
                        <span class="input-group-append"></span>
                        <input type="text" name="fecha_mercancia" class="form-control w-100"
                               id="fecha_mercancia">
                    </div>
                    <div class="col-4 mt-0 form-group input-group input-group-sm d-block">
                        <label for="existencia_mercancia" class="font-weight-bold">Existencia</label>
                        <span class="input-group-append"></span>
                        <input type="text" name="existencia_mercancia" class="form-control w-100"
                               id="existencia_mercancia">
                    </div>
                    <div class="col-4 mt-0 form-group input-group input-group-sm d-block p-0">
                        <label for="existencia_incremento_mercancia" class="font-weight-bold">Existencia + incremento</label>
                        <span class="input-group-append"></span>
                        <input type="text" name="existencia_incremento_mercancia" class="form-control w-100"
                               id="existencia_incremento_mercancia">
                    </div>
                </div>
                <div class="row mt-0 p-0">
                    <div class="col-6 form-group input-group input-group-sm pa-2 d-block">
                        <label for="cuenta_inventario" class="font-weight-bold">Cuenta de inventario.</label>
                        <span class="input-group-append"></span>
                        <input type="text" name="cuenta_inventario" class="form-control w-100"
                               id="cuenta_inventario">
                    </div>
                    <div class="col-6 mt-0 form-group input-group input-group-sm d-block p-0">
                        <label for="cuenta_acreedora" class="font-weight-bold">Cuenta acreedora</label>
                        <span class="input-group-append"></span>
                        <input type="text" name="cuenta_acreedora" class="form-control w-100"
                               id="cuenta_acreedora">
                    </div>

                </div>
                <div class="row mt-0 p-0">
                    <div class="col-6 form-group input-group input-group-sm pa-2 d-block">
                        <label for="subcuenta_inventario" class="font-weight-bold">Subcuenta de inventario.</label>
                        <span class="input-group-append"></span>
                        <input type="text" name="subcuenta_inventario" class="form-control w-100"
                               id="subcuenta_inventario">
                    </div>
                    <div class="col-6 mt-0 form-group input-group input-group-sm d-block p-0">
                        <label for="proveedor" class="font-weight-bold">Proveedor</label>
                        <span class="input-group-append"></span>
                        <select type="text" name="proveedor" class="form-control w-100"
                                id="proveedor"></select>
                    </div>

                </div>
                <div class="d-flex mt-2">
                    <div class="mr-auto">
                        <a href="{{ url('contabilidad_inventario_informe_recepcion') }}"
                           class="btn btn-outline-secondary" id="btn_cancelar">Cancelar</a>
                    </div>
                    <div class="ml-2">
                        <button type="button" class="my-0 btn btn-secondary" id="btnAceptar">Aceptar</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script>
        $('#unidad_medida').prepend('<option selected = "true" value = "0" disabled>Seleccione la UM</option>');
        $('#proveedor').prepend('<option selected = "true" value = "0" disabled>Seleccione el proveedor</option>');
        $(document).ready(function () {
            $.ajax({
                url: '/contabilidad/inventario/informe-recepcion/getUM',
                method: 'POST',
                dataType: 'json',
                success: function (result) {
                    $(result.unidad_medidas).each(function (pos, valor) {
                            $('#unidad_medida').append('<option value = "'+valor.id+'">'+valor.nombre+'</option>');
                    })
                },
                error: function () {
                }
            })
            $.ajax({
                url: '/contabilidad/inventario/informe-recepcion/getProveedor',
                method: 'POST',
                dataType: 'json',
                success: function (result) {
                    $(result.proveedores).each(function (pos, valor) {
                        $('#proveedor').append('<option value = "'+valor.id+'">('+valor.codigo+') '+valor.nombre+'</option>');
                    })
                },
                error: function () {
                }
            })
            $('#btnSearchMercancia').on('click', function () {
                $.ajax({
                    url: '/contabilidad/inventario/informe-recepcion/getMercancias',
                    method: 'POST',
                    dataType: 'json',
                    success: function (result) {
                        $(result.mercancias).each(function (pos, valor) {
                                $('#rows_table').append('<tr>' +
                                    '<td style="font-weight:400;"> ' +
                                    '<input type="checkbox" style="margin-left: auto;" id="' + valor.codigo + '">' +
                                    '</td>' +
                                    '<td style="font-weight:400;"> ' + valor.codigo + '</td>' +
                                    '<td style="font-weight:400;"> ' + valor.descripcion + '</td> </tr>'+
                                    '<td style="font-weight:400;"> ' + valor.precio_compra + '</td> </tr>'
                                );
                        })
                    },
                    error: function () {
                    }
                })
            })
        })
    </script>
{% endblock %}

